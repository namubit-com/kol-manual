<!DOCTYPE html>

<html data-theme="dark" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>NAMUBIT — Unified Binance &amp; OKX Trading via Official APIs</title>
<meta content="Trade spot and futures on Binance and OKX with one account and a single KYC. Secure Fireblocks custody, official API execution, and smart routing." name="description"/>
<link href="https://www.namubit.com/app" rel="canonical"/>
<!-- Robots -->
<meta content="index,follow,max-image-preview:large" name="robots"/>
<!-- Hreflang -->
<link href="https://www.namubit.com/app" hreflang="x-default" rel="alternate"/>
<link href="https://www.namubit.com/app" hreflang="en" rel="alternate"/>
<link href="https://www.namubit.com/app?lang=ja" hreflang="ja" rel="alternate"/>
<!-- Open Graph / Twitter -->
<meta content="website" property="og:type"/>
<meta content="NAMUBIT — Unified Binance &amp; OKX Trading via Official APIs" property="og:title"/>
<meta content="Trade spot and futures on Binance and OKX with one account and a single KYC. Secure Fireblocks custody, official API execution, and smart routing." property="og:description"/>
<meta content="https://www.namubit.com/app" property="og:url"/>
<meta content="/assets/og-namubit-1200x630.png" property="og:image"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="NAMUBIT — Unified Binance &amp; OKX Trading" name="twitter:title"/>
<meta content="Trade spot and futures on Binance and OKX with one account and a single KYC. Secure Fireblocks custody, official API execution, and smart routing." name="twitter:description"/>
<meta content="/assets/og-namubit-1200x630.png" name="twitter:image"/>
<!-- Performance -->
<link crossorigin="" href="https://www.namubit.com" rel="preconnect"/>
<link crossorigin="" href="https://www.binance.com" rel="preconnect"/>
<link crossorigin="" href="https://www.okx.com" rel="preconnect"/>
<!-- PWA / Icons (optional placeholders) -->
<link href="/favicon-32.png" rel="icon" sizes="32x32"/>
<link href="/apple-touch-icon.png" rel="apple-touch-icon"/>
<!-- JSON-LD -->
<style>
    :root{ --radius:20px; --ring: 0 0 0 3px rgba(37, 99, 235, .35); }
    :root, [data-theme="dark"]{
      --primary:#2563eb; --primary-600:#1d4ed8; --accent:#ef4444; --spot:#2563eb;
      --bg:#0b1220; --card:#0f172a; --muted:#64748b; --text:#e2e8f0; --border:#172036; --border-strong:#243249;
      --tile-grad-1: rgba(17,24,39,.75); --tile-grad-2: rgba(7,11,22,.75);
      --pill-bg:#0b1324; --pill-border:#243249; --pill-border-hover:#2f4466;
      --delta-bg:#052e1e; --delta-border:#065f46;
      --shadow: 0 10px 30px rgba(0,0,0,.25); --page-grad: radial-gradient(1200px 800px at 20% -10%, #1f2937 0%, #0b1220 55%, #05070d 100%);
      --up:#10b981; --down:#ef4444; --chip:#0b1324;
    }
    [data-theme="light"]{
      --primary:#2563eb; --primary-600:#1d4ed8; --accent:#dc2626; --spot:#1d4ed8;
      --bg:#f8fafc; --card:#ffffff; --muted:#475569; --text:#0f172a; --border:#e2e8f0; --border-strong:#cbd5e1;
      --pill-bg:#ffffff; --pill-border:#e2e8f0; --pill-border-hover:#cbd5e1;
      --delta-bg:#ecfdf5; --delta-border:#6ee7b7;
      --shadow: 0 8px 20px rgba(2,6,23,.08); --page-grad: linear-gradient(180deg, #f8fafc, #f1f5f9);
      --up:#059669; --down:#b91c1c; --chip:#fff;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{ margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans", Arial, sans-serif; background: var(--page-grad); color:var(--text); line-height:1.5; }
    .container{max-width:1200px; margin:0 auto; padding:24px}
    .topbar{display:flex; gap:12px; justify-content:flex-end; align-items:center; margin:6px 0 0}
    .seg{display:inline-flex; border:1px solid var(--border); border-radius:12px; overflow:hidden; background:var(--card)}
    .seg button{background:transparent; border:0; padding:8px 12px; cursor:pointer; color:var(--muted); font-weight:700}
    .seg button[aria-pressed="true"]{ color:var(--text) }
    .toggle{border:1px solid var(--border); border-radius:999px; padding:6px 10px; cursor:pointer; background:var(--card); color:var(--muted); font-weight:700}
    .grid{display:grid; grid-template-columns: 1.2fr 1fr; gap:20px; align-items:stretch}
    .card{background:linear-gradient(180deg, var(--card), color-mix(in oklab, var(--card) 90%, transparent)); border:1px solid var(--border); border-radius:var(--radius); padding:18px; box-shadow: var(--shadow); display:flex; flex-direction:column; min-height:100%;}
    .headline{font-size:30px; font-weight:800; margin:0 0 8px}
    .muted{color:var(--muted); font-size:14px}
    .balance{display:flex; align-items:baseline; gap:10px; flex-wrap:wrap; font-weight:800; font-size:28px; letter-spacing:.3px}
    .delta{font-weight:700;font-size:14px;padding:4px 8px;border-radius:8px;background:transparent;color:var(--text);border:1px solid color-mix(in oklab, var(--text), transparent 60%);}
    .cta-row{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
    .btn{display:inline-flex; align-items:center; gap:8px; background:var(--primary); color:white; padding:12px 16px; border-radius:12px; border:none; font-weight:700; cursor:pointer; transition:.2s transform ease, .2s background ease, .2s box-shadow ease; box-shadow:0 8px 24px color-mix(in oklab, var(--primary), transparent 70%)}
    .btn:hover{background:var(--primary-600); transform:translateY(-1px)}
    .btn:focus-visible{outline:none; box-shadow:var(--ring)}
    .btn.secondary{background:var(--card); color:var(--text); border:1px solid var(--border); box-shadow:none}

    /* Quick Trade (unchanged) */
    .pill-row{ display:grid; grid-template-columns:repeat(2, minmax(0,1fr)); gap:12px; }
    .pill{ width:100%; justify-content:space-between; display:inline-flex; align-items:center; gap:8px; border:2px solid color-mix(in oklab, var(--text), transparent 55%); padding:10px 12px; border-radius:12px; transition:.2s transform ease, .2s border-color ease, .2s background ease; background:color-mix(in oklab, var(--card) 90%, transparent); text-decoration:none; color:inherit}
    .pill:hover{transform:translateY(-1px); border-color:var(--pill-border-hover)}
    .pill .tag{font-size:12px; padding:4px 8px; border-radius:999px; color:white}
    .tag.futures{background:var(--accent)} .tag.spot{background:var(--spot)}

    .tiles{display:grid; grid-template-columns: repeat(3, 1fr); gap:14px; margin-top:14px}
    .tile{padding:16px; border-radius:var(--radius); background:linear-gradient(180deg, rgba(17,24,39,.75), rgba(7,11,22,.75)); border:1px solid var(--border)}
    .tile h4{margin:0 0 8px; font-size:14px}
    @media (max-width: 980px){ .grid{grid-template-columns: 1fr} .tiles{grid-template-columns: 1fr} }

    /* Japanese typography */
    body[lang="ja"], :lang(ja){
      font-family: Meiryo, "Hiragino Kaku Gothic ProN", "Noto Sans JP", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    }

    [data-theme=light] .tile{
      background:linear-gradient(180deg, var(--card), color-mix(in oklab, var(--card) 92%, transparent));
      border-color:var(--border-strong);
    }
    [data-theme=light] .tile h4{ color:var(--text-strong); }
    [data-theme=light] .tile p,
    [data-theme=light] .tile .sub,
    [data-theme=light] .tile .muted{ color:var(--muted); }

    /* --- New: Market Search + Results styles --- */
    .search-wrap{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin:10px 0 6px }
    .input{ flex:1 1 260px; min-width:220px; background:var(--card); color:var(--text); border:1px solid var(--border-strong); border-radius:12px; padding:12px 14px; font-size:16px }
    .input::placeholder{ color:var(--muted) }
    .help{ font-size:12px; color:var(--muted) }

    .results{ margin-top:12px; display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap:12px }
    @media (max-width:680px){ .results{ grid-template-columns: 1fr } }

    .quote{ border:1px solid var(--border-strong); border-radius:14px; padding:14px; background:linear-gradient(180deg, var(--card), color-mix(in oklab, var(--card) 88%, transparent)) }
    .quote .row{ display:flex; justify-content:space-between; align-items:baseline; gap:10px }
    .quote .ex{ font-weight:800; font-size:14px; letter-spacing:.2px }
    .quote .inst{ font-size:12px; color:var(--muted) }
    .quote .px{ font-weight:900; font-size:22px }
    .quote .cta{ display:inline-flex; gap:8px; align-items:center; margin-top:10px; font-weight:700; text-decoration:none }

    .diffs{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:12px; margin-top:12px }
    @media (max-width:680px){ .diffs{ grid-template-columns: 1fr } }
    .diff{ border:1px dashed var(--border-strong); border-radius:12px; padding:12px; background:var(--chip) }
    .diff .label{ font-size:12px; color:var(--muted) }
    .diff .val{ font-weight:800; font-size:16px }
    .pos{ color:var(--up) } .neg{ color:var(--down) }

    a:visited{ color: inherit; }
  </style>
<meta content="crypto exchange, unified trading, Binance API, OKX API, spot trading, futures trading, single KYC, smart routing, Fireblocks custody, USDT markets" name="keywords"/>
<meta content="NAMUBIT" property="og:site_name"/>
<meta content="en_US" property="og:locale"/>
<meta content="ja_JP" property="og:locale:alternate"/>
<meta content="@namubit" name="twitter:site"/>
<meta content="@namubit" name="twitter:creator"/>
<meta content="Hxht2P4eBnSy72AGRPu7h4inenbzhJvARm7oHP7aK74" name="google-site-verification"/>
<meta content="REPLACE_WITH_NAVER_TOKEN" name="naver-site-verification"/>
<script type="application/ld+json">{"@context": "https://schema.org", "@type": "Organization", "name": "NAMUBIT", "url": "https://www.namubit.com/", "logo": "https://www.namubit.com/assets/logo.png", "sameAs": ["https://x.com/namubit", "https://www.linkedin.com/company/namubit", "https://t.me/namubit"]}</script>
<script type="application/ld+json">{"@context": "https://schema.org", "@type": "WebSite", "name": "NAMUBIT", "url": "https://www.namubit.com/app", "inLanguage": "en", "potentialAction": {"@type": "SearchAction", "target": "https://www.namubit.com/appsearch?q={query}", "query-input": "required name=query"}}</script>
<script type="application/ld+json">{"@context": "https://schema.org", "@type": "WebPage", "name": "NAMUBIT — Unified Binance & OKX Trading via Official APIs", "url": "https://www.namubit.com/app", "inLanguage": "en", "description": "Trade spot and futures on Binance and OKX with one account and a single KYC. Secure Fireblocks custody, official API execution, and smart routing.", "isPartOf": {"@id": "https://www.namubit.com/app"}}</script>
</head>
<body lang="en">
<header class="container">
<div class="topbar">
<div aria-label="Language" class="seg" role="tablist" style="display:none">
<button aria-pressed="true" id="lang-en" role="tab">EN</button>
<button aria-pressed="false" id="lang-ja" role="tab">日本語</button>
</div>
<button aria-pressed="false" class="toggle" id="themeToggle" title="Toggle theme">☀︎ / ☾</button>
</div>
<div class="badge" data-i18n="header.placeholder">Header will remain as on namubit.com (not modified here).</div>
</header>
<main class="container grid">
<section class="card">
<p class="muted" data-i18n="welcome">Welcome back — let’s trade.</p>
<h1 class="headline" data-i18n="quickTrade.title">Quick Trade</h1>
<p class="muted" data-i18n="quickTrade.subtitle">Your markets, one click away</p>
<div class="pill-row" style="margin-top:12px">
<a aria-label="Go to Binance Futures" class="pill" href="https://www.namubit.com/futures/binance/BTCUSDT">
<span class="tag futures">Futures</span><strong><img alt="BINANCE" src="bin.png" style="height:14px;vertical-align:middle"/></strong><span class="muted">Go →</span>
</a>
<a aria-label="Go to OKX Futures" class="pill" href="https://www.namubit.com/futures/okx/BTC-USDT-SWAP">
<span class="tag futures">Futures</span><strong><img alt="OKX" src="OKX.png" style="height:14px;vertical-align:middle"/></strong><span class="muted">Go →</span>
</a>
<a aria-label="Go to Binance Spot" class="pill" href="https://www.namubit.com/spot/binance/BTCUSDT">
<span class="tag spot">Spot</span><strong><img alt="BINANCE" src="bin.png" style="height:14px;vertical-align:middle"/></strong><span class="muted">Go →</span>
</a>
<a aria-label="Go to OKX Spot" class="pill" href="https://www.namubit.com/spot/okx/BTC-USDT">
<span class="tag spot">Spot</span><strong><img alt="OKX" src="OKX.png" style="height:14px;vertical-align:middle"/></strong><span class="muted">Go →</span>
</a>
</div>
<!-- NEW: Market Search -->
<div style="margin-top:22px"></div>
<h2 class="headline" data-i18n="market.title" style="font-size:22px; margin:0 0 6px">Market Search</h2>
<p class="muted help" data-i18n="market.help">Type a symbol only (e.g., BTC). Suffixes like USDT or -USDT-SWAP are optional.</p>
<div class="search-wrap">
<input aria-label="Symbol" autocomplete="off" class="input" id="sym" inputmode="latin" placeholder="BTC, ETH, SOL…"/>
<button class="btn" data-i18n="market.searchBtn" id="go">Search</button>
<button class="btn secondary" data-i18n="market.resetBtn" id="reset">Reset</button>
</div>
<div aria-live="polite" class="results" id="results"></div>
<div aria-live="polite" class="diffs" id="diffs"></div>
<div style="margin-top:auto"></div>
</section>
<aside class="card">
<h2 class="headline" data-i18n="wallet.title" style="font-size:22px; margin:0 0 10px">My Wallet</h2>
<div class="balance">
<span data-i18n="wallet.balanceLabel">💰 Estimated Balance</span>
<span>— USDT</span>
</div>
<div style="margin-top:8px">
<span class="delta" data-i18n="wallet.changeToday">Today’s Change +0</span>
</div>
<div class="cta-row">
<a class="btn" data-i18n="wallet.ctaWallet" href="https://www.namubit.com/wallet">Go to Wallet</a>
<a class="btn secondary" data-i18n="wallet.ctaSecurity" href="https://www.namubit.com/regist">Account &amp; Security</a>
</div>
<p class="muted" style="margin-top:14px">Figures are placeholders. Connect to your backend to hydrate with real data.</p>
<div style="margin-top:auto"></div>
</aside>
</main>
<section class="container">
<div class="tiles">
<div class="tile">
<h4 data-i18n="why.allInOne.title">All‑in‑One Access</h4>
<p class="muted" data-i18n="why.allInOne.body">Single KYC for Binance &amp; OKX with real‑time API trading.</p>
</div>
<div class="tile">
<h4 data-i18n="why.custody.title">Institutional‑Grade Custody</h4>
<p class="muted" data-i18n="why.custody.body">Fireblocks third‑party licensed custodian.</p>
</div>
<div class="tile">
<h4 data-i18n="why.aiPricing.title">AI‑Powered Pricing</h4>
<p class="muted" data-i18n="why.aiPricing.body">Live prices and smart routing for maker‑level fees and market speed.</p>
</div>
</div>
</section>
<footer class="container">
<div class="badge" data-i18n="footer.placeholder">Footer will remain as on namubit.com (not modified here).</div>
</footer>
<script>
    // Theme
    const root = document.documentElement;
    const themeBtn = document.getElementById('themeToggle');
    const storedTheme = localStorage.getItem('theme');
    if(storedTheme){ root.setAttribute('data-theme', storedTheme); themeBtn.setAttribute('aria-pressed', storedTheme==='light'); }
    themeBtn.addEventListener('click', () => {
      const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      root.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
      themeBtn.setAttribute('aria-pressed', next==='light');
    });
    if(!storedTheme && window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches){
      root.setAttribute('data-theme', 'light');
      themeBtn.setAttribute('aria-pressed', true);
    }

    // i18n (EN/JA)
    const dict = {"en": {"welcome": "Welcome back — let’s trade.", "quickTrade.title": "Quick Trade", "quickTrade.subtitle": "Your markets, one click away", "wallet.title": "My Wallet", "wallet.balanceLabel": "💰 Estimated Balance", "wallet.changeToday": "Today’s Change +0", "wallet.ctaWallet": "Go to Wallet", "wallet.ctaSecurity": "Account & Security", "why.allInOne.title": "All‑in‑One Access", "why.allInOne.body": "Single KYC for Binance & OKX with real‑time API trading.", "why.custody.title": "Institutional‑Grade Custody", "why.custody.body": "Fireblocks third‑party licensed custodian.", "why.aiPricing.title": "AI‑Powered Pricing", "why.aiPricing.body": "Live prices and smart routing for maker‑level fees and market speed.", "header.placeholder": "Header will remain as on namubit.com (not modified here).", "footer.placeholder": "Footer will remain as on namubit.com (not modified here).", "market.title": "Market Search", "market.help": "Type a symbol only (e.g., BTC). Suffixes like USDT or -USDT-SWAP are optional.", "market.searchBtn": "Search", "market.resetBtn": "Reset", "market.spotDiff": "Spot Diff (Binance vs OKX)", "market.futDiff": "Futures Diff (Binance vs OKX)"}};
    const langButtons = { en: document.getElementById('lang-en'), ja: document.getElementById('lang-ja') };
    function applyLang(l){
      document.body.setAttribute('lang', l);
      Object.keys(langButtons).forEach(k => langButtons[k].setAttribute('aria-pressed', k===l));
      document.querySelectorAll('[data-i18n]').forEach(el => { const key = el.getAttribute('data-i18n'); if(dict[l] && dict[l][key]) el.innerHTML = dict[l][key]; });
      localStorage.setItem('lang', l);
    }
    const storedLang = localStorage.getItem('lang');
    applyLang('en');
    langButtons.en.addEventListener('click', () => applyLang('en'));
    langButtons.ja.addEventListener('click', () => applyLang('ja'));

    // --- Market Search Logic ---
    const input = document.getElementById('sym');
    const goBtn = document.getElementById('go');
    const resetBtn = document.getElementById('reset');
    const resultsEl = document.getElementById('results');
    const diffsEl = document.getElementById('diffs');

    function normalizeSymbol(raw){
      if(!raw) return '';
      let s = (raw + '').toUpperCase().trim();
      // strip common suffixes and separators
      s = s.replace(/[^A-Z0-9\-]/g, '');
      s = s.replace(/-USDT-SWAP$/,'');
      s = s.replace(/-USDT$/,'');
      s = s.replace(/USDT$/,'');
      s = s.replace(/^[\-\s]+|[\-\s]+$/g, '');
      if(s.includes('-')) s = s.split('-')[0];
      return s;
    }

    function symMap(sym){
      // Build instrument ids for each venue/type
      return {
        binance: {
          spot: { id: sym + 'USDT', trade: `https://www.namubit.com/spot/binance/${sym}USDT` },
          fut:  { id: sym + 'USDT', trade: `https://www.namubit.com/futures/binance/${sym}USDT` }
        },
        okx: {
          spot: { id: sym + '-USDT', trade: `https://www.namubit.com/spot/okx/${sym}-USDT` },
          fut:  { id: sym + '-USDT-SWAP', trade: `https://www.namubit.com/futures/okx/${sym}-USDT-SWAP` }
        }
      };
    }

    async function fetchFromNamubit(symbol){
      // Try a few likely JSON endpoints FIRST (preferred by request)
      const candidates = [
        `/market?json=1&symbol=${symbol}`,
        `/market.json?symbol=${symbol}`,
        `/api/market?symbol=${symbol}`,
        `/api/quotes?symbol=${symbol}`,
        `/api/v1/quotes?symbol=${symbol}`
      ];
      for(const url of candidates){
        try{
          const r = await fetch(url, { credentials: 'include' });
          if(r.ok){
            const ct = r.headers.get('content-type') || '';
            if(ct.includes('application/json')){
              const j = await r.json();
              // Expect shape like { binance:{spot:{price}, fut:{price}}, okx:{spot:{price}, fut:{price}} }
              if(j && (j.binance || j.okx)) return j;
            }
          }
        }catch(e){ /* ignore and continue */ }
      }
      // As a fallback, attempt to scrape /market for embedded JSON
      try{
        const r = await fetch('/market', { credentials: 'include' });
        if(r.ok){
          const html = await r.text();
          const m = html.match(/<script[^>]*id=["']__DATA__["'][^>]*>([\s\S]*?)<\/script>/);
          if(m){
            const data = JSON.parse(m[1]);
            if(data && (data.binance || data.okx)) return data;
          }
        }
      }catch(e){ /* ignore */ }
      return null;
    }

    async function fetchDirect(map){
      // Public exchange APIs (used only if NAMUBIT aggregate is unavailable)
      function j(url){ return fetch(url).then(r => r.json()); }
      const [biSpot, biFut, okSpot, okFut] = await Promise.all([
        j(`https://api.binance.com/api/v3/ticker/price?symbol=${map.binance.spot.id}`),
        j(`https://fapi.binance.com/fapi/v1/ticker/price?symbol=${map.binance.fut.id}`),
        j(`https://www.okx.com/api/v5/market/ticker?instId=${map.okx.spot.id}`),
        j(`https://www.okx.com/api/v5/market/ticker?instId=${map.okx.fut.id}`)
      ]);
      const toNum = v => typeof v === 'string' ? parseFloat(v) : (v && v.last ? parseFloat(v.last) : NaN);
      return {
        binance: { spot: { price: parseFloat(biSpot.price) }, fut: { price: parseFloat(biFut.price) } },
        okx: { spot: { price: parseFloat(okSpot.data?.[0]?.last) }, fut: { price: parseFloat(okFut.data?.[0]?.last) } }
      };
    }

    async function getQuotes(symbol){
      const map = symMap(symbol);
      // 1) Preferred: from NAMUBIT /market (per requirement)
      const fromN = await fetchFromNamubit(symbol);
      if(fromN && fromN.binance && fromN.okx){ return { map, quotes: fromN, source: 'namubit' }; }
      // 2) Fallback: direct from exchanges
      const direct = await fetchDirect(map);
      return { map, quotes: direct, source: 'public' };
    }

    function fmt(n){ if(n==null || !isFinite(n)) return '—'; return Number(n).toLocaleString(undefined, { maximumFractionDigits: 6 }); }
    function pct(a,b){ if(!isFinite(a) || !isFinite(b)) return NaN; const mid=(a+b)/2; return (a-b)/mid*100; }

    function render(symbol, map, quotes, source){
      const BIN_ICON = '<img src="bin.png" alt="BINANCE" style="height:14px;vertical-align:middle">';
      const OKX_ICON = '<img src="OKX.png" alt="OKX" style="height:14px;vertical-align:middle">';
      resultsEl.innerHTML = '';
      diffsEl.innerHTML = '';

      const cards = [
        { key:['binance','spot'], label: BIN_ICON + ' · Spot',     inst: map.binance.spot.id, trade: map.binance.spot.trade },
        { key:['binance','fut'],  label: BIN_ICON + ' · Futures',  inst: map.binance.fut.id,  trade: map.binance.fut.trade },
        { key:['okx','spot'],     label: OKX_ICON + ' · Spot',     inst: map.okx.spot.id,     trade: map.okx.spot.trade },
        { key:['okx','fut'],      label: OKX_ICON + ' · Futures',  inst: map.okx.fut.id,      trade: map.okx.fut.trade },
      ];
      const vals = {};
      for(const c of cards){
        const [ex, tp] = c.key; const v = quotes?.[ex]?.[tp]?.price; vals[`${ex}_${tp}`] = v;
        const el = document.createElement('div'); el.className='quote';
        el.innerHTML = `
          <div class="row">
            <div>
              <div class="ex">${c.label}</div>
              <div class="inst">${c.inst}</div>
            </div>
            <div class="px">${fmt(v)}</div>
          </div>
          <a class="cta" href="${c.trade}" aria-label="Trade ${symbol} on ${c.label}">Trade →</a>
        `;
        resultsEl.appendChild(el);
      }

      // Diffs (Binance vs OKX)
      const spotA = vals['binance_spot'], spotB = vals['okx_spot'];
      const futA  = vals['binance_fut'],  futB  = vals['okx_fut'];
      const spotDiff = spotA - spotB; const spotPct = pct(spotA, spotB);
      const futDiff  = futA  - futB;  const futPct  = pct(futA, futB);
      const sClass = spotDiff >= 0 ? 'pos' : 'neg';
      const fClass = futDiff  >= 0 ? 'pos' : 'neg';

      diffsEl.innerHTML = `
        <div class="diff"><div class="label" data-i18n="market.spotDiff">Spot Diff (Binance vs OKX)</div>
          <div class="val ${sClass}">${fmt(spotDiff)} USDT · ${isFinite(spotPct)?spotPct.toFixed(3):'—'}%</div></div>
        <div class="diff"><div class="label" data-i18n="market.futDiff">Futures Diff (Binance vs OKX)</div>
          <div class="val ${fClass}">${fmt(futDiff)} USDT · ${isFinite(futPct)?futPct.toFixed(3):'—'}%</div></div>`;

      // Optional watermark of source
      const small = document.createElement('div');
      small.className='help';
      small.style.marginTop = '8px';
      small.textContent = source === 'namubit' ? 'Data source: NAMUBIT /market' : 'Data source: Public exchange APIs (fallback)';
      diffsEl.appendChild(small);
    }

    async function run(symbolRaw){
      const sym = normalizeSymbol(symbolRaw || input.value);
      if(!sym){ input.focus(); return; }
      input.value = sym; // show normalized (e.g., BTC)
      // pre-render skeleton
      resultsEl.innerHTML = '<div class="muted">Loading…</div>';
      diffsEl.innerHTML = '';
      try{
        const { map, quotes, source } = await getQuotes(sym);
        render(sym, map, quotes, source);
      }catch(e){
        resultsEl.innerHTML = '<div class="muted">No data. Please try another symbol.</div>';
      }
    }

    // Events
    goBtn.addEventListener('click', () => run());
    resetBtn.addEventListener('click', () => { input.value=''; resultsEl.innerHTML=''; diffsEl.innerHTML=''; input.focus(); });
    input.addEventListener('keydown', (e) => { if(e.key==='Enter') run(); });

    // Default: preload BTC
    run('BTC');
  </script>
</body>
</html>
